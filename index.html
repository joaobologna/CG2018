<html>
	<head>
		<title>Projeto CG - Fase 01</title>
		<style>
			body { margin: 0; overflow: 0; }
			canvas { width: 100%; height: 100%; };
		</style>
	</head>
	<body>
		<canvas id="myCanvas"></canvas>
		<script src="js/three.js"></script>
		<script src="js/THREEx.KeyboardState.js"></script>
		
		<script>
			var keyboard = new THREEx.KeyboardState();
			
			init();		
			animate();

			function init() {
				// Renderer
				renderer = create_renderer();
				
				// Camera
				camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 1000);
			
				// Cena
				scene = new THREE.Scene();

				// Carregar gato
				load_obj('json/cat.json');

				function create_renderer() {
					var myCanvas = document.getElementById('myCanvas');
			
					renderer = new THREE.WebGLRenderer({
					  canvas: myCanvas, 
					  antialias: true
					});
			
					// Renderer
					renderer.setClearColor(0x000000);
					renderer.setPixelRatio(window.devicePixelRatio);
					renderer.setSize(window.innerWidth, window.innerHeight);
					
					return renderer;				
				}

				function load_obj(path) {
					loader = new THREE.JSONLoader();
					loader.load(path, handle_load);
			
					function handle_load(geometry, materials) {
						materials = new THREE.MeshNormalMaterial();
						mesh = new THREE.Mesh(geometry, materials);
						mesh.scale.set(4, 2, 2); // alteração do tamanho do objeto para melhor visualização
						scene.add(mesh);
						scene.position.z = -10;
					}			
				}		
			}
			
			function animate() {
				requestAnimationFrame(animate);
				rotation();
				render();	
			}

			function render() {
				renderer.clear();
				renderer.render(scene, camera);
			}

			function rotation() {
				var speed = 0.1;

				if(keyboard.pressed("D")) { mesh.rotation.y += speed; }
				if(keyboard.pressed("A")) { mesh.rotation.y -= speed; }
				if(keyboard.pressed("W")) { mesh.rotation.x += speed; }
				if(keyboard.pressed("S")) { mesh.rotation.x -= speed; }
			}
	
		</script>
	</body>
</html>
